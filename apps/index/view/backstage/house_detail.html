
{include file='backstage/index'}
<head>
<link rel="stylesheet" href="../../../public/static/css/zyupload-1.0.0.min.css " type="text/css">
    <style>
        #zyupload{
            display: none;
        }
    </style>
</head>
<body>


   

<div class=" admin-content">
	
		<div class="daohang">
			<ul>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs"> 首页 </li>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">帮助中心<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">奖金管理<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">产品管理<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
				
				
			</ul>

       

	
</div>
	
	


<div class="admin-biaogelist">
	
    <div class="listbiaoti am-cf">
      <ul class="am-icon-flag on"> 添加新房屋</ul>
      
      <dl class="am-icon-home" style="float: right;"> 当前位置： 首页 > <a href="#">新增房屋</a></dl>

      
      
    </div>
	
    <div class="fbneirong">
			<form class="am-form" method="post" action='../../index/backstage/modify_form_data/id={$data.id}'>
        <div class="am-form-group am-cf">
          <div class="zuo">标题：</div>
          <div class="you">
            <input type="text" class="am-input-sm" name='house_title' id="house_title" value="{$data.title}">
          </div>
        </div>
        <div class="am-form-group am-cf">
          <div class="zuo">关键词：</div>
          <div class="you">
            <input type="text" class="am-input-sm" name='key_word' id="key_word" value="{$data.key_word}">
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">出租类型：</div>
          <div class="you">
          	<label class="am-checkbox-inline">
            <input type="radio" name='rent_type' value="1" {if condition='$data.rent_type eq 1'}checked{/if}>
            	长租</label>
          <label class="am-checkbox-inline">
            <input type="radio" name='rent_type' value="0" {if condition='$data.rent_type eq 0'}checked{/if}>
            	短租 </label>
          </div>
        </div>
               
        <div class="am-form-group am-cf">
          <div class="zuo">价格：</div>
          <div class="you">
          	<input type='text' name='price' class='am-input-sm' style='width:10%' id='price' value="{$data.price}" />
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">地区：</div>
          <div class="you">
          	<select class='am-input-sm' name='area' style='width:15%;float:left;' id='district' value=''>
          		{foreach name='location' id='loc'}
          		<option value='{$loc.l_id}' {if condition='$data.district eq $loc.l_id'}selected{/if}>{$loc.location_name}</option>
          		{/foreach}
          	</select>
          	<select class='am-input-sm' name='street' style='width:15%;float:left;margin-left:1%;margin-right: 1%;' id='street' >
          		<option value=''>不限</option>
          	</select>
          	<input type='text' class='am-input-sm' name='village' style='width:10%;float:left;margin-right: 1%;' id='village' value='{$data.address}' />
          	<input type='text' class='am-input-sm' name='addr' style='width:30%;float:left;' id='addr' value='{$data.addr}' />
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">地铁：</div>
          <div class="you">
          	<select class='am-input-sm' name='underground' style='width:15%;float:left;' id='line' value=''>
          		{foreach name='line' id='line_list'}
          		<option value='{$line_list.u_id}' {if condition='$data.district eq $line_list.u_id'}selected{/if}>{$line_list.underground_name}</option>
          		{/foreach}
          	</select>
          	<select class='am-input-sm' name='station' style='width:15%;float:left;margin-left:1%;margin-right: 1%;' id='station' value=''>
          		<option value=''>不限</option>
          	</select>
          </div>
        </div>        
        
        <div class="am-form-group am-cf">
          <div class="zuo">户型：</div>
          <div class="you">
          	<select class='am-input-sm' style='width:10%;' id='house_type' name='house_type'>
          		{foreach name='house_type' id='type_list'}
          			<option value='{$type_list.t_id}' {if condition='$data.house_type eq $type_list.t_id'}selected{/if}>{$type_list.house_type_name}</option>
          		{/foreach}
          	</select>
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">面积：</div>
          <div class="you">
          <input type='text' class='am-input-sm' name='acreage' style='width:10%' id='acreage' value="{$data.acreage}" />
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">层高：</div>
          <div class="you">
          <input type='text' class='am-input-sm' name='floor' style='width:10%' id='floor' value="{$data.house_floor}" />
          </div>
        </div>
        
        
        <div class="am-form-group am-cf">
          <div class="zuo">设施：</div>
          <div class="you">
          	{foreach name='furniture' id='furniture_list' key='key'}
          	<label class="am-checkbox-inline">
            <input type="checkbox" name='furniture[]' value="{$furniture_list.t_id}" {if condition='$data.fur_list[$key] eq $furniture_list.t_id'}checked{/if}>
            	{$furniture_list.furniture_name}
          	</label>
          	{/foreach}
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">经度：</div>
          <div class="you">
          <input type='text' name='longitude' class='am-input-sm' style='width:10%' id='longitude' value="{$data.longitude}" />
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">纬度：</div>
          <div class="you">
          <input type='text' name='latitude' class='am-input-sm' style='width:10%' id='latitude' value="{$data.latitude}" />
          </div>
        </div>
        
        <div class="am-form-group am-cf">
          <div class="zuo">描述：</div>
          <div class="you">
            <textarea class=""  id="remark" name='remarks' style="height: 10em;">{$data.remark}</textarea>
          </div>
        </div>
        
        <div class="am-form-group am-cf show">
          <div class="zuo">产品图片：</div>
          <div class="you" style="height: 50%;">
          	<div id="show_pic" style='float:left;' class="zyupload">
                {foreach name='pic' id='pic'}
                <img src="__pic__/uploads/{$pic}" style="width:30%;margin-bottom:5%;"/>
                {/foreach}
            </div>
              <div id="zyupload" style='float:left;' class="zyupload"></div>
              <input type='hidden' name='pic_addr' id='pic_addr' value=''  />
              <input type="button" class="reupload_pic" value="点击修改图片" />
              <span style="font-size: 140%;color:red;">*警告！请重新上传所有图片</span>
          </div>
        </div>
        
        <div class="am-form-group am-cf">
        <div class="zuo">房东：</div>
        <div class="you" style="margin-top: 5px;">
     		<input type='text' name='landlord' class='am-input-sm' style='width:15%' id='landlord' value="{$data.landlord}" />
            </div>
        </div>
        <div class="am-form-group am-cf">
          <div class="you" style="margin-left: 11%;">
              <button type='submit' id='house_sub' class="am-btn am-btn-success am-radius">修改房屋信息</button>
          </div>
        </div>
      </form>
    </div>
</div>
</div>
</div>

<script src="../../../public/static/js/backstage/amazeui.min.js"></script>
<script src="../../../public/static/js/zyupload.basic-1.0.0.min.js"></script>
</body>
</html>
<script type='text/javascript'>
    var pic_arr = new Array();
    $(function(){
        $('#pic_addr').val('');
        // 初始化插件
        $("#zyupload").zyUpload({
            width            :   "100%",                 // 宽度
            height					 :   "auto",
            itemWidth        :   "140px",                 // 文件项的宽度
            itemHeight       :   "115px",                 // 文件项的高度
            url              :   "./up",              // 上传文件的路径
            fileType         :   ["jpg","png"],// 上传文件的类型
            fileSize         :   51200000,                // 上传文件的大小
            multiple         :   true,                    // 是否可以多个文件上传
            dragDrop         :   false,                   // 是否可以拖动上传文件
            tailor           :   false,                   // 是否可以裁剪图片
            del              :   true,                    // 是否可以删除文件
            finishDel        :   false,  				  // 是否在上传文件完成后删除预览
            /* 外部获得的回调接口 */
            onSelect: function(selectFiles, allFiles){    // 选择文件的回调方法  selectFile:当前选中的文件  allFiles:还没上传的全部文件
                console.info("当前选择了以下文件：");
                console.info(selectFiles);
            },
            onDelete: function(file, files){              // 删除一个文件的回调方法 file:当前删除的文件  files:删除之后的文件
                console.info("当前删除了此文件：");
                console.info(file.name);
            },
            onSuccess: function(file, response){ // 文件上传成功的回调方法
                pic_arr.push(file.name);
                $('#pic_addr').val(pic_arr);
            },
            onFailure: function(file, response){          // 文件上传失败的回调方法
                console.info("此文件上传失败：");
                console.info(response);
            },
            onComplete: function(response){           	  // 上传完成的回调方法
                console.info("文件上传完成");
                console.info(response);
            }
        });

    });
$('#district').change(function(){
		$.ajax({  
                type: "POST",  
                url:"../../../index.php/index/backstage/get_street",
                data:{'id':$('#district').val()},
                dataType: "json", 
                success: function(data) {
                			//$('#street').empty();
                			var ob='';
											$.each(data,function(i,value){
												ob = ob + '<option value="'+value.l_id+'">'+value.location_name+'</option>';
											})
									$('#street').html(ob);
                }  
           }); 
	})
	$('#line').change(function(){
		$.ajax({  
                type: "POST",  
                url:"../../../index.php/index/backstage/get_station",
                data:{'id':$('#line').val()},
                dataType: "json", 
                success: function(data) {
                			//$('#street').empty();
                			var ob='';
											$.each(data,function(i,value){
												ob = ob + '<option value="'+value.u_id+'">'+value.underground_name+'</option>';
											})
									$('#station').html(ob);
                }  
           }); 
	})
    $('.reupload_pic').click(function(){
        $('#show_pic').css('display','none');
        $('#zyupload').css('display','block');
    })
</script>